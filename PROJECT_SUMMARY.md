# プロジェクトサマリー

## 📦 KIT工房 確定申告対応会計システム（Supabase連携版）

個人事業主向けの完全クラウド対応会計管理アプリケーション

---

## 🎯 プロジェクト概要

### 目的
KIT工房（奥井啓太様）の個人事業における日々の会計管理と、青色申告（複式簿記・65万円控除）に対応した確定申告書類の作成支援

### 主要な変更点（Supabase連携版）
- ✅ データ保存先をローカルストレージからSupabase（PostgreSQL）に変更
- ✅ 複数デバイス（PC・スマホ）でのデータ共有が可能に
- ✅ クラウド上でデータが永続化され、ブラウザキャッシュクリアの影響を受けない
- ✅ 本番環境（Vercel）でのデプロイに完全対応

---

## 📂 ファイル構成

```
kit-kobo-accounting/
├── index.html                # メインアプリケーション（21.5 KB）
├── css/
│   └── style.css            # スタイルシート（9.1 KB）
├── js/
│   └── app.js               # Supabase連携アプリロジック（50.6 KB）
├── README.md                 # プロジェクト詳細（14.6 KB）
├── QUICKSTART.md             # 5分でスタートガイド（4.1 KB）
├── DEPLOYMENT.md             # デプロイ手順書（10.7 KB）
├── supabase-setup.sql        # Supabaseテーブル作成SQL（8.9 KB）
├── .env.example              # 環境変数サンプル（1.4 KB）
└── .gitignore                # Git除外設定
```

**合計サイズ**: 約 130 KB（軽量！）

---

## 🔧 技術スタック

### フロントエンド
- **HTML5**: セマンティックHTML、レスポンシブデザイン
- **CSS3**: グラデーション、アニメーション、モバイル最適化
- **JavaScript (ES6+)**: async/await、アロー関数、テンプレートリテラル

### バックエンド（クラウド）
- **Supabase**: PostgreSQL データベース
  - Row Level Security (RLS)
  - RESTful API
  - リアルタイム同期（将来的に活用可能）

### ライブラリ（CDN経由）
- **Chart.js 4.4.0**: グラフ描画
- **jsPDF 2.5.1**: PDF生成
- **encoding-japanese 2.0.0**: CSV文字コード変換（Shift-JIS対応）
- **Supabase JS Client 2.x**: Supabase連携

### ホスティング
- **Vercel**: 自動デプロイ、SSL自動発行、CDN配信

---

## ✨ 実装済み機能

### 1. 複式簿記による記帳
- [x] 借方・貸方の仕訳入力
- [x] 20種類の勘定科目マスタ
- [x] 金額の自動バランスチェック
- [x] 月別フィルタリング
- [x] Supabaseへの自動保存

### 2. 見積書管理
- [x] 自動採番（Q-2025-001形式）
- [x] 顧客選択機能
- [x] 有効期限自動計算（90日後）
- [x] 明細管理
- [x] 自動計算（小計・消費税・合計）
- [ ] PDF出力（実装予定）
- [ ] 見積書→請求書変換（実装予定）

### 3. 請求書管理
- [x] 自動採番（I-2025-001形式）
- [x] 顧客選択機能
- [x] 支払期限自動計算（45日後）
- [x] 振込先情報自動表示
- [x] 支払済み処理
- [x] 自動仕訳生成（売掛金/売上高）
- [ ] PDF出力（実装予定）

### 4. 顧客管理
- [x] CRUD操作（登録・表示・削除）
- [x] 見積書・請求書での自動選択肢表示
- [x] Supabaseへの保存

### 5. サービス管理
- [x] サービス情報の登録
- [x] カテゴリ別管理（9カテゴリ）
- [x] 単価・税率設定

### 6. CSV一括インポート
- [x] あおぞら銀行フォーマット対応
- [x] Shift-JIS/CP932自動検出
- [x] 科目自動推測（AI風）
- [x] プレビュー＆編集機能
- [x] 一括登録
- [x] Supabaseへの保存

### 7. ダッシュボード
- [x] 年間サマリー（売上・経費・利益・未払い）
- [x] Chart.jsによるグラフ表示
  - 月別損益推移（折れ線グラフ）
  - 経費内訳（ドーナツグラフ）
- [x] 最近の仕訳一覧

### 8. 確定申告レポート
- [x] 青色申告決算書（損益計算書）自動生成
- [x] 確定申告書転記用データ出力
- [x] 青色申告特別控除 65万円対応
- [x] 科目別集計表
- [x] e-Tax申告ガイド
- [ ] CSV出力（実装予定）
- [ ] 印刷機能（実装予定）

---

## 🔒 セキュリティ実装

### 現在の実装
- ✅ Supabase Row Level Security (RLS) 有効化
- ✅ 環境変数でAPIキー管理
- ✅ `.gitignore` で機密情報を除外
- ⚠️ 開発環境用RLSポリシー（すべてのユーザーに権限付与）

### 本番運用時に推奨
- [ ] Supabase Authによるユーザー認証
- [ ] RLSポリシーの強化（認証ユーザーのみアクセス）
- [ ] ユーザー別データ分離
- [ ] 定期的なバックアップ

---

## 📱 レスポンシブデザイン

### 対応デバイス
- ✅ デスクトップ（1400px以上）
- ✅ ラップトップ（1024px〜1400px）
- ✅ タブレット（768px〜1024px）
- ✅ スマートフォン（480px〜768px）
- ✅ 小型スマホ（480px以下）

### モバイル最適化
- ✅ タッチ操作に適したボタンサイズ
- ✅ 縦並びレイアウト（仕訳帳の借方・貸方）
- ✅ フォントサイズ16px以上（iOS自動ズーム防止）
- ✅ ナビゲーション非固定（入力エリア拡大）

---

## 🚀 デプロイ状況

### 開発環境
- ローカルサーバーで動作確認済み
- Supabase接続テスト済み

### 本番環境（予定）
- **ホスティング**: Vercel
- **データベース**: Supabase
- **URL**: `https://kit-kobo-accounting.vercel.app`（予定）
- **独自ドメイン**: 設定可能

---

## 📊 データベーススキーマ

### テーブル一覧

1. **customers**（顧客）
   - id, name, company, address, phone, email, created_at

2. **services**（サービス）
   - id, name, category, unit_price, unit, tax_rate, created_at

3. **journal_entries**（仕訳帳）
   - id, date, debit_account, debit_amount, credit_account, credit_amount, description, created_at

4. **invoices**（請求書）
   - id, invoice_number, customer_id, issue_date, due_date, items, subtotal, tax, total, status, created_at

5. **quotations**（見積書）
   - id, quote_number, customer_id, issue_date, expiry_date, items, subtotal, tax, total, created_at

### インデックス
- 日付での高速検索（journal_entries.date）
- 顧客関連付け（invoices.customer_id, quotations.customer_id）
- ステータス検索（invoices.status）

---

## 🎓 使い方（基本フロー）

### 初期セットアップ
1. Supabaseプロジェクト作成
2. `supabase-setup.sql` を実行
3. APIキーを取得
4. `js/app.js` に設定
5. Vercelにデプロイ

### 日常業務
1. **顧客・サービス登録**（初回のみ）
2. **日々の記帳**
   - 売上発生時: 売掛金 / 売上高
   - 入金時: 普通預金 / 売掛金
   - 経費支払時: 経費科目 / 普通預金
3. **月次処理**
   - あおぞら銀行CSVをダウンロード
   - CSV一括インポート
   - 科目を確認・修正
   - 一括登録
4. **見積書・請求書作成**
   - 顧客選択
   - 明細入力
   - PDF出力（実装予定）

### 年次処理（確定申告）
1. 「確定申告レポート」タブを開く
2. 年度を選択（例: 2025年）
3. 「レポート生成」をクリック
4. 転記用データをメモ
5. [国税庁 確定申告書等作成コーナー](https://www.keisan.nta.go.jp/)にアクセス
6. e-Taxで電子申告
7. **青色申告特別控除 65万円を受ける！**

---

## 💡 今後の改善案

### 優先度：高
- [ ] PDF生成機能の完全実装（jsPDF + 日本語フォント）
- [ ] 明細入力UIの改善（動的追加・削除）
- [ ] 見積書→請求書変換機能
- [ ] データエクスポート機能（CSV、Excel）

### 優先度：中
- [ ] ユーザー認証機能（Supabase Auth）
- [ ] 複数ユーザー対応（RLS強化）
- [ ] 貸借対照表の自動生成
- [ ] 在庫管理機能

### 優先度：低
- [ ] 他の銀行CSVフォーマット対応
- [ ] モバイルアプリ版（React Native）
- [ ] 多言語対応（英語、中国語）
- [ ] ダークモード

---

## 🧪 テスト状況

### 手動テスト
- ✅ 顧客CRUD操作
- ✅ サービスCRUD操作
- ✅ 仕訳入力・表示
- ✅ ダッシュボードグラフ表示
- ✅ CSV一括インポート（あおぞら銀行）
- ✅ レスポンシブデザイン（各デバイス）
- ⏳ PDF生成（未実装）
- ⏳ 見積書→請求書変換（未実装）

### 自動テスト
- [ ] ユニットテスト（未実装）
- [ ] E2Eテスト（未実装）

---

## 📝 ドキュメント

| ファイル | 内容 | 対象読者 |
|---------|------|----------|
| README.md | 詳細な機能説明、技術仕様 | 開発者・運用者 |
| QUICKSTART.md | 5分でスタートガイド | 初めてのユーザー |
| DEPLOYMENT.md | デプロイ手順書 | 運用者 |
| supabase-setup.sql | DB作成スクリプト | 開発者 |
| PROJECT_SUMMARY.md | プロジェクトサマリー | 全員 |

---

## 🎉 完成度

### 実装済み機能: 約80%
- ✅ コア機能（記帳、顧客管理、CSV）: 100%
- ✅ Supabase連携: 100%
- ✅ ダッシュボード: 100%
- ✅ レスポンシブデザイン: 100%
- ⏳ PDF生成: 30%（構造のみ）
- ⏳ 明細入力UI: 50%（基本構造のみ）

### プロダクション準備度: 70%
- ✅ 基本機能が動作
- ✅ データ永続化
- ⏳ セキュリティ強化が必要
- ⏳ PDF生成の完全実装が必要

---

## 🏆 成果物の特徴

### 優れている点
1. **軽量**: 合計130KB（画像なし）
2. **高速**: CDN経由のライブラリ読み込み
3. **シンプル**: 依存関係が少ない
4. **拡張性**: Supabaseで簡単にスケール
5. **保守性**: コードが読みやすい

### 改善の余地
1. PDF生成の日本語対応
2. ユーザー認証の実装
3. エラーハンドリングの強化
4. テストコードの追加

---

## 📞 連絡先

**開発者**: AIディベロッパー  
**クライアント**: KIT工房（奥井啓太様）  
**プロジェクト開始**: 2025年12月  
**最終更新**: 2025年12月16日

---

**このプロジェクトで、KIT工房様の確定申告が楽になりますように！🎉**
